<nav class="navbar navbar-expand-lg navbar-light bg-light" role="navigation">
  <div class="container-fluid">
    {#- Brand and toggle get grouped for better mobile display -#}
    <a class="navbar-brand" href="{{ url_for('index.index') }}">
      <img src="{{ url_for('static', filename='img/navbar_logo.svg') }}" alt="ListenBrainz" />
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggle" aria-controls="navbarToggle" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    {#- Collect the nav links, forms, and other content for toggling -#}
    <div class="collapse navbar-collapse" id="navbarToggle">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        {% if not hide_navbar_user_menu %}
        {% if current_user.is_authenticated %}
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('user.profile', user_name=current_user.musicbrainz_id) }}">
            Home
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('index.feed') }}">
            Feed
          </a>
        </li>
        {% endif %}
        {%- endif -%}
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('index.recent_listens') }}">
            Recent
          </a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="dataDropdown" role="button" data-bs-toggle="dropdown" href="#" aria-expanded="false">
            Data<span class="caret"></span>
          </a>
          <ul class="dropdown-menu" aria-labelledby="dataDropdown">
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.add_data_info') }}">
                Adding data
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.import_data_info') }}">
                Importing data
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.data') }}">
                Using our data
              </a>
            </li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="exploreDropdown" role="button" data-bs-toggle="dropdown" href="#" aria-expanded="false">
            Explore<span class="caret"></span>
          </a>
          <ul class="dropdown-menu" aria-labelledby="exploreDropdown">
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.huesound') }}">
                Hue Sound
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.similar_users') }}">
              Top similar users
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('user.year_in_music', user_name=current_user.musicbrainz_id) }}">
                Your Year In Music
              </a>
            </li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="aboutDropdown" role="button" data-bs-toggle="dropdown" href="#" aria-expanded="false">
            About<span class="caret"></span>
          </a>
          <ul class="dropdown-menu" aria-labelledby="aboutDropdown">
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.about') }}">
                About ListenBrainz
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.messybrainz') }}">
              MessyBrainz
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://listenbrainz.readthedocs.io">
                API Docs
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.current_status') }}">
                Current site status
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('index.terms_of_service') }}">
                Terms of service
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://metabrainz.org">
                About MetaBrainz
              </a>
            </li>
          </ul>
        </li>
      </ul>

      <form class="d-flex" role="search" method="GET" action="/search">
        <input type="text" name="search_term" class="form-control me-2" placeholder="Search Listener" required/>
        <button type="submit" class="btn btn-primary input-sm">
          <i class="fas fa-search"></i>
        </button>
      </form>

      {% if not hide_navbar_user_menu %}
      <ul class="nav navbar-nav">
        {% if not current_user.is_authenticated or current_user.is_anonymous %}
        <li class="nav-item">
          <a class="nav-link" href="{{ url_for('login.index') }}">Sign in</a>
        </li>
        {% else %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="profileDropdown" role="button" data-bs-toggle="dropdown" href="#" aria-expanded="false">
            {{ current_user.musicbrainz_id }} <span class="caret"></span>
          </a>
          <ul class="dropdown-menu" aria-labelledby="profileDropdown">
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('profile.info') }}">
                Settings
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('user.playlists', user_name=current_user.musicbrainz_id) }}">
                Playlists
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('recommendations_cf_recording.info', user_name=current_user.musicbrainz_id) }}">
                Tracks you might like
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('profile.music_services_details') }}">
                Connect Services
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('profile.import_data') }}">
                Import listens
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('profile.export_data') }}">
                Export
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('user.missing_mb_data', user_name=current_user.musicbrainz_id) }}">
                Add Missing MusicBrainz Data
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('login.logout') }}">
                Sign out
              </a>
            </li>
          </ul>
        </li>
        {%- endif -%}
      </ul>
      {% endif %}
    </div>
  </div>
</nav>
